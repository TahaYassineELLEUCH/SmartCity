[2017-10-15 14:41:03,387] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 0 (state.change.logger)
[2017-10-15 14:41:03,407] TRACE Broker 1 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 0 (state.change.logger)
[2017-10-15 14:41:03,408] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 0 (state.change.logger)
[2017-10-15 14:41:03,637] TRACE Broker 1 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@2308a4a0 correlation id 1 from controller 0 epoch 11 for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:41:03,637] TRACE Broker 1 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@12b7c690 correlation id 1 from controller 0 epoch 11 for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:41:03,695] TRACE Broker 1 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 11 starting the become-follower transition for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:41:03,696] TRACE Broker 1 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 11 starting the become-follower transition for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:41:03,696] ERROR Broker 1 received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 11 for partition [conso-maisons,0] but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2017-10-15 14:41:03,697] ERROR Broker 1 received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 11 for partition [kafka-topic,0] but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2017-10-15 14:41:03,986] TRACE Broker 1 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 11 for the become-follower transition for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:41:03,986] TRACE Broker 1 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 11 for the become-follower transition for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:41:04,000] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 2 (state.change.logger)
[2017-10-15 14:41:04,005] TRACE Broker 1 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 2 (state.change.logger)
[2017-10-15 14:41:04,005] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 2 (state.change.logger)
[2017-10-15 14:41:04,020] TRACE Broker 1 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@7aa1fad0 correlation id 3 from controller 0 epoch 11 for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:41:04,020] TRACE Broker 1 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@74660bf4 correlation id 3 from controller 0 epoch 11 for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:41:04,021] TRACE Broker 1 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 11 starting the become-leader transition for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:41:04,021] TRACE Broker 1 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 11 starting the become-leader transition for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:41:04,290] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 11 for partition [conso-maisons,0] since it is already the leader for the partition. (state.change.logger)
[2017-10-15 14:41:04,291] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 11 for partition [kafka-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-10-15 14:41:04,292] TRACE Broker 1 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 11 for the become-leader transition for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:41:04,293] TRACE Broker 1 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 11 for the become-leader transition for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:41:04,297] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 4 (state.change.logger)
[2017-10-15 14:41:04,298] TRACE Broker 1 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 4 (state.change.logger)
[2017-10-15 14:41:04,299] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 4 (state.change.logger)
[2017-10-15 14:41:38,880] TRACE Controller 1 epoch 12 changed state of replica 1 for partition [kafka-topic,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-10-15 14:41:38,900] TRACE Controller 1 epoch 12 changed state of replica 1 for partition [conso-maisons,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-10-15 14:41:38,918] TRACE Controller 1 epoch 12 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 1 for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:41:38,918] TRACE Controller 1 epoch 12 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 1 for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:41:38,998] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 1 for partition conso-maisons-0 (state.change.logger)
[2017-10-15 14:41:38,998] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:11) to broker 1 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:41:38,999] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 1 for partition kafka-topic-0 (state.change.logger)
[2017-10-15 14:41:39,873] TRACE Broker 1 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@40591ace correlation id 0 from controller 1 epoch 12 for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:41:39,873] TRACE Broker 1 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@4a4909a correlation id 0 from controller 1 epoch 12 for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:41:39,875] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 0 epoch 12 for partition [kafka-topic,0] since its associated leader epoch 4 is old. Current leader epoch is 4 (state.change.logger)
[2017-10-15 14:41:39,876] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 0 epoch 12 for partition [conso-maisons,0] since its associated leader epoch 4 is old. Current leader epoch is 4 (state.change.logger)
[2017-10-15 14:41:39,881] TRACE Controller 1 epoch 12 received response {error_code=0,partitions=[{topic=conso-maisons,partition=0,error_code=11},{topic=kafka-topic,partition=0,error_code=11}]} for a request sent to broker localhost:9093 (id: 1 rack: null) (state.change.logger)
[2017-10-15 14:41:39,883] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 1 (state.change.logger)
[2017-10-15 14:41:39,883] TRACE Broker 1 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 1 (state.change.logger)
[2017-10-15 14:41:39,883] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 1 (state.change.logger)
[2017-10-15 14:41:39,884] TRACE Controller 1 epoch 12 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null) (state.change.logger)
[2017-10-15 14:41:39,923] TRACE Controller 1 epoch 12 started leader election for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:41:40,063] ERROR Controller 1 epoch 12 initiated state change for partition [conso-maison,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [conso-maison,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:146)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:141)
	at org.I0Itec.zkclient.ZkClient$9.run(ZkClient.java:824)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-10-15 14:41:40,400] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 1 for partition conso-maisons-0 (state.change.logger)
[2017-10-15 14:41:40,400] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:11) to broker 1 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:41:40,401] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 1 for partition kafka-topic-0 (state.change.logger)
[2017-10-15 14:41:40,409] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 2 (state.change.logger)
[2017-10-15 14:41:40,409] TRACE Broker 1 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 2 (state.change.logger)
[2017-10-15 14:41:40,409] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 2 (state.change.logger)
[2017-10-15 14:41:40,411] TRACE Controller 1 epoch 12 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null) (state.change.logger)
[2017-10-15 14:42:02,990] TRACE Controller 0 epoch 13 started leader election for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:42:03,002] ERROR Controller 0 epoch 13 initiated state change for partition [kafka-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:684)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController.startup(KafkaController.scala:680)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:200)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:37)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-10-15 14:42:03,004] TRACE Controller 0 epoch 13 started leader election for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:42:03,033] ERROR Controller 0 epoch 13 initiated state change for partition [conso-maisons,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [conso-maisons,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:684)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController.startup(KafkaController.scala:680)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:200)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:37)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-10-15 14:42:03,034] TRACE Controller 0 epoch 13 started leader election for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:42:03,056] ERROR Controller 0 epoch 13 initiated state change for partition [conso-maison,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [conso-maison,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:684)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController.startup(KafkaController.scala:680)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:200)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:37)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-10-15 14:42:03,382] TRACE Controller 0 epoch 13 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 0 for partition conso-maisons-0 (state.change.logger)
[2017-10-15 14:42:03,382] TRACE Controller 0 epoch 13 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:11) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:42:03,382] TRACE Controller 0 epoch 13 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 0 for partition kafka-topic-0 (state.change.logger)
[2017-10-15 14:42:03,501] TRACE Controller 0 epoch 13 changed state of replica 0 for partition [conso-maison,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-10-15 14:42:03,502] TRACE Controller 0 epoch 13 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:11) to broker 0 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:42:03,505] TRACE Controller 0 epoch 13 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:11) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:42:03,506] TRACE Controller 0 epoch 13 started leader election for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:42:03,507] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 0 (state.change.logger)
[2017-10-15 14:42:03,508] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 0 (state.change.logger)
[2017-10-15 14:42:03,508] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 0 (state.change.logger)
[2017-10-15 14:42:03,530] TRACE Controller 0 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:42:03,576] ERROR Controller 0 epoch 13 initiated state change for partition [kafka-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka-topic,0] is alive. Live brokers are: [Set(0)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:433)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:375)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:843)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-10-15 14:42:03,577] TRACE Controller 0 epoch 13 started leader election for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:42:03,590] ERROR Controller 0 epoch 13 initiated state change for partition [conso-maisons,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [conso-maisons,0] is alive. Live brokers are: [Set(0)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:433)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:375)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:843)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-10-15 14:42:03,590] TRACE Controller 0 epoch 13 started leader election for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:42:03,650] TRACE Broker 0 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@1184dd59 correlation id 1 from controller 0 epoch 13 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:42:03,684] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 13 starting the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:42:03,741] TRACE Controller 0 epoch 13 elected leader 0 for Offline partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:42:03,744] TRACE Controller 0 epoch 13 changed partition [conso-maison,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-10-15 14:42:03,744] TRACE Controller 0 epoch 13 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:13) to broker 0 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:42:03,744] TRACE Controller 0 epoch 13 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:13) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:42:03,762] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 13 with correlation id 1 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:42:03,763] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 13 for the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:42:03,788] TRACE Controller 0 epoch 13 received response {error_code=0,partitions=[{topic=conso-maison,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:42:03,789] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 2 (state.change.logger)
[2017-10-15 14:42:03,792] TRACE Controller 0 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:42:03,793] TRACE Broker 0 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@1157d22b correlation id 3 from controller 0 epoch 13 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:42:03,793] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 13 starting the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:42:03,795] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 13 for partition [conso-maison,0] since it is already the leader for the partition. (state.change.logger)
[2017-10-15 14:42:03,795] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 13 for the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:42:03,797] TRACE Controller 0 epoch 13 received response {error_code=0,partitions=[{topic=conso-maison,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:42:03,798] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 4 (state.change.logger)
[2017-10-15 14:42:03,799] TRACE Controller 0 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:54:05,178] TRACE Controller 0 epoch 14 started leader election for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:54:05,195] ERROR Controller 0 epoch 14 initiated state change for partition [kafka-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:684)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController.startup(KafkaController.scala:680)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:200)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:37)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-10-15 14:54:05,197] TRACE Controller 0 epoch 14 started leader election for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:54:05,223] ERROR Controller 0 epoch 14 initiated state change for partition [conso-maisons,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [conso-maisons,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:684)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController.startup(KafkaController.scala:680)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:200)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:37)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-10-15 14:54:05,223] TRACE Controller 0 epoch 14 started leader election for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:54:05,247] ERROR Controller 0 epoch 14 initiated state change for partition [conso-maison,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [conso-maison,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:684)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController.startup(KafkaController.scala:680)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:200)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:37)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-10-15 14:54:05,581] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 0 for partition conso-maisons-0 (state.change.logger)
[2017-10-15 14:54:05,581] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:13) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:54:05,581] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 0 for partition kafka-topic-0 (state.change.logger)
[2017-10-15 14:54:05,702] TRACE Controller 0 epoch 14 changed state of replica 0 for partition [conso-maison,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-10-15 14:54:05,703] TRACE Controller 0 epoch 14 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:13) to broker 0 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:54:05,707] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:13) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:54:05,708] TRACE Controller 0 epoch 14 started leader election for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:54:05,741] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 0 (state.change.logger)
[2017-10-15 14:54:05,742] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 0 (state.change.logger)
[2017-10-15 14:54:05,742] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 0 (state.change.logger)
[2017-10-15 14:54:05,762] TRACE Controller 0 epoch 14 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:54:05,770] ERROR Controller 0 epoch 14 initiated state change for partition [kafka-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka-topic,0] is alive. Live brokers are: [Set(0)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:433)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:375)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:843)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-10-15 14:54:05,771] TRACE Controller 0 epoch 14 started leader election for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:54:05,826] ERROR Controller 0 epoch 14 initiated state change for partition [conso-maisons,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [conso-maisons,0] is alive. Live brokers are: [Set(0)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:433)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:375)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:843)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-10-15 14:54:05,827] TRACE Controller 0 epoch 14 started leader election for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:54:05,885] TRACE Broker 0 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@65b195ce correlation id 1 from controller 0 epoch 14 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:54:05,895] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 14 starting the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:54:05,960] TRACE Controller 0 epoch 14 elected leader 0 for Offline partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:54:05,963] TRACE Controller 0 epoch 14 changed partition [conso-maison,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-10-15 14:54:05,963] TRACE Controller 0 epoch 14 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:14) to broker 0 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:54:05,963] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:14) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:54:05,977] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 14 with correlation id 1 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:54:05,981] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 14 for the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:54:06,005] TRACE Controller 0 epoch 14 received response {error_code=0,partitions=[{topic=conso-maison,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:54:06,006] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 2 (state.change.logger)
[2017-10-15 14:54:06,009] TRACE Controller 0 epoch 14 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:54:06,010] TRACE Broker 0 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@49f9281a correlation id 3 from controller 0 epoch 14 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:54:06,010] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 14 starting the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:54:06,012] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 14 for partition [conso-maison,0] since it is already the leader for the partition. (state.change.logger)
[2017-10-15 14:54:06,012] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 14 for the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:54:06,013] TRACE Controller 0 epoch 14 received response {error_code=0,partitions=[{topic=conso-maison,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:54:06,014] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 4 (state.change.logger)
[2017-10-15 14:54:06,019] TRACE Controller 0 epoch 14 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:54:47,640] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 1 for partition conso-maisons-0 (state.change.logger)
[2017-10-15 14:54:47,640] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:14) to broker 1 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:54:47,640] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 1 for partition kafka-topic-0 (state.change.logger)
[2017-10-15 14:54:47,640] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 0 for partition conso-maisons-0 (state.change.logger)
[2017-10-15 14:54:47,641] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:14) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:54:47,641] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 0 for partition kafka-topic-0 (state.change.logger)
[2017-10-15 14:54:47,642] TRACE Controller 0 epoch 14 changed state of replica 1 for partition [kafka-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-10-15 14:54:47,642] TRACE Controller 0 epoch 14 changed state of replica 1 for partition [conso-maisons,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-10-15 14:54:47,642] TRACE Controller 0 epoch 14 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 1 for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:54:47,642] TRACE Controller 0 epoch 14 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 1 for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:54:47,642] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 1 for partition conso-maisons-0 (state.change.logger)
[2017-10-15 14:54:47,643] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:14) to broker 1 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:54:47,643] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 1 for partition kafka-topic-0 (state.change.logger)
[2017-10-15 14:54:47,643] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 0 for partition conso-maisons-0 (state.change.logger)
[2017-10-15 14:54:47,643] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:14) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:54:47,643] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11) to broker 0 for partition kafka-topic-0 (state.change.logger)
[2017-10-15 14:54:47,644] TRACE Controller 0 epoch 14 started leader election for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:54:47,648] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 5 (state.change.logger)
[2017-10-15 14:54:47,648] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 5 (state.change.logger)
[2017-10-15 14:54:47,648] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 5 (state.change.logger)
[2017-10-15 14:54:47,650] TRACE Controller 0 epoch 14 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:54:47,652] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 6 (state.change.logger)
[2017-10-15 14:54:47,653] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 6 (state.change.logger)
[2017-10-15 14:54:47,653] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 6 (state.change.logger)
[2017-10-15 14:54:47,654] TRACE Controller 0 epoch 14 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:54:47,710] TRACE Controller 0 epoch 14 elected leader 1 for Offline partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:54:47,711] TRACE Controller 0 epoch 14 changed partition [kafka-topic,0] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-10-15 14:54:47,711] TRACE Controller 0 epoch 14 started leader election for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:54:47,728] TRACE Controller 0 epoch 14 elected leader 1 for Offline partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:54:47,729] TRACE Controller 0 epoch 14 changed partition [conso-maisons,0] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-10-15 14:54:47,729] TRACE Controller 0 epoch 14 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:14) to broker 1 for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:54:47,729] TRACE Controller 0 epoch 14 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:14) to broker 1 for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:54:47,730] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:14) to broker 1 for partition conso-maisons-0 (state.change.logger)
[2017-10-15 14:54:47,730] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:14) to broker 1 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:54:47,730] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:14) to broker 1 for partition kafka-topic-0 (state.change.logger)
[2017-10-15 14:54:47,730] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:14) to broker 0 for partition conso-maisons-0 (state.change.logger)
[2017-10-15 14:54:47,730] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:14) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:54:47,730] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:14) to broker 0 for partition kafka-topic-0 (state.change.logger)
[2017-10-15 14:54:47,732] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 7 (state.change.logger)
[2017-10-15 14:54:47,732] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 7 (state.change.logger)
[2017-10-15 14:54:47,732] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 7 (state.change.logger)
[2017-10-15 14:54:47,733] TRACE Controller 0 epoch 14 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:54:47,788] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 0 (state.change.logger)
[2017-10-15 14:54:47,794] TRACE Broker 1 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 0 (state.change.logger)
[2017-10-15 14:54:47,795] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 0 (state.change.logger)
[2017-10-15 14:54:47,809] TRACE Controller 0 epoch 14 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null) (state.change.logger)
[2017-10-15 14:54:47,918] TRACE Broker 1 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@a0b692 correlation id 1 from controller 0 epoch 14 for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:54:47,919] TRACE Broker 1 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@233eef4 correlation id 1 from controller 0 epoch 14 for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:54:47,956] TRACE Broker 1 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 14 starting the become-leader transition for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:54:47,973] TRACE Broker 1 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 14 starting the become-leader transition for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:54:48,041] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 14 with correlation id 1 for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:54:48,041] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 14 with correlation id 1 for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:54:48,042] TRACE Broker 1 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 14 for the become-leader transition for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:54:48,042] TRACE Broker 1 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 14 for the become-leader transition for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:54:48,057] TRACE Controller 0 epoch 14 received response {error_code=0,partitions=[{topic=conso-maisons,partition=0,error_code=0},{topic=kafka-topic,partition=0,error_code=0}]} for a request sent to broker localhost:9093 (id: 1 rack: null) (state.change.logger)
[2017-10-15 14:54:48,061] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 2 (state.change.logger)
[2017-10-15 14:54:48,061] TRACE Broker 1 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 2 (state.change.logger)
[2017-10-15 14:54:48,061] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 2 (state.change.logger)
[2017-10-15 14:54:48,064] TRACE Controller 0 epoch 14 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null) (state.change.logger)
[2017-10-15 14:54:48,065] TRACE Broker 1 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@4b5ef709 correlation id 3 from controller 0 epoch 14 for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:54:48,066] TRACE Broker 1 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@45991012 correlation id 3 from controller 0 epoch 14 for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:54:48,066] TRACE Broker 1 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 14 starting the become-leader transition for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:54:48,066] TRACE Broker 1 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 14 starting the become-leader transition for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:54:48,067] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 14 for partition [conso-maisons,0] since it is already the leader for the partition. (state.change.logger)
[2017-10-15 14:54:48,068] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 14 for partition [kafka-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-10-15 14:54:48,068] TRACE Broker 1 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 14 for the become-leader transition for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:54:48,068] TRACE Broker 1 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 14 for the become-leader transition for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:54:48,073] TRACE Controller 0 epoch 14 received response {error_code=0,partitions=[{topic=conso-maisons,partition=0,error_code=0},{topic=kafka-topic,partition=0,error_code=0}]} for a request sent to broker localhost:9093 (id: 1 rack: null) (state.change.logger)
[2017-10-15 14:54:48,077] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 4 (state.change.logger)
[2017-10-15 14:54:48,077] TRACE Broker 1 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 4 (state.change.logger)
[2017-10-15 14:54:48,077] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 4 (state.change.logger)
[2017-10-15 14:54:48,078] TRACE Controller 0 epoch 14 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null) (state.change.logger)
[2017-10-15 14:56:19,668] TRACE Controller 0 epoch 14 changed partition [kafka-topic,0] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-10-15 14:56:19,669] TRACE Controller 0 epoch 14 changed partition [conso-maisons,0] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-10-15 14:56:19,669] TRACE Controller 0 epoch 14 started leader election for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:56:19,676] ERROR Controller 0 epoch 14 initiated state change for partition [kafka-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka-topic,0] is alive. Live brokers are: [Set(0)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:474)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:377)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:843)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-10-15 14:56:19,677] TRACE Controller 0 epoch 14 started leader election for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:56:19,689] ERROR Controller 0 epoch 14 initiated state change for partition [conso-maisons,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [conso-maisons,0] is alive. Live brokers are: [Set(0)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:474)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:377)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:843)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-10-15 14:56:19,724] TRACE Controller 0 epoch 14 changed state of replica 1 for partition [kafka-topic,0] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-10-15 14:56:19,742] TRACE Controller 0 epoch 14 changed state of replica 1 for partition [conso-maisons,0] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-10-15 14:56:19,742] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:6,ControllerEpoch:14) to broker 0 for partition conso-maisons-0 (state.change.logger)
[2017-10-15 14:56:19,742] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:14) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:56:19,742] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:6,ControllerEpoch:14) to broker 0 for partition kafka-topic-0 (state.change.logger)
[2017-10-15 14:56:19,748] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:6,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 8 (state.change.logger)
[2017-10-15 14:56:19,748] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 8 (state.change.logger)
[2017-10-15 14:56:19,748] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:6,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 8 (state.change.logger)
[2017-10-15 14:56:19,749] TRACE Controller 0 epoch 14 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:56:36,581] TRACE Controller 0 epoch 15 started leader election for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:56:36,604] ERROR Controller 0 epoch 15 initiated state change for partition [kafka-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:684)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController.startup(KafkaController.scala:680)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:200)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:37)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-10-15 14:56:36,606] TRACE Controller 0 epoch 15 started leader election for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:56:36,654] ERROR Controller 0 epoch 15 initiated state change for partition [conso-maisons,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [conso-maisons,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:684)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController.startup(KafkaController.scala:680)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:200)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:37)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-10-15 14:56:36,655] TRACE Controller 0 epoch 15 started leader election for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:56:36,668] ERROR Controller 0 epoch 15 initiated state change for partition [conso-maison,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [conso-maison,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:684)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController.startup(KafkaController.scala:680)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:200)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:37)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-10-15 14:56:37,207] TRACE Controller 0 epoch 15 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:6,ControllerEpoch:14) to broker 0 for partition conso-maisons-0 (state.change.logger)
[2017-10-15 14:56:37,207] TRACE Controller 0 epoch 15 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:14) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:56:37,207] TRACE Controller 0 epoch 15 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:6,ControllerEpoch:14) to broker 0 for partition kafka-topic-0 (state.change.logger)
[2017-10-15 14:56:37,255] TRACE Controller 0 epoch 15 changed state of replica 0 for partition [conso-maison,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-10-15 14:56:37,256] TRACE Controller 0 epoch 15 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:14) to broker 0 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:56:37,259] TRACE Controller 0 epoch 15 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:14) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:56:37,259] TRACE Controller 0 epoch 15 started leader election for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:56:37,298] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:6,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 15 with correlation id 0 (state.change.logger)
[2017-10-15 14:56:37,299] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 15 with correlation id 0 (state.change.logger)
[2017-10-15 14:56:37,299] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:6,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 0 epoch 15 with correlation id 0 (state.change.logger)
[2017-10-15 14:56:37,310] ERROR Controller 0 epoch 15 initiated state change for partition [kafka-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka-topic,0] is alive. Live brokers are: [Set(0)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:433)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:375)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:843)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-10-15 14:56:37,310] TRACE Controller 0 epoch 15 started leader election for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:56:37,348] ERROR Controller 0 epoch 15 initiated state change for partition [conso-maisons,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [conso-maisons,0] is alive. Live brokers are: [Set(0)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:433)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:375)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:843)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-10-15 14:56:37,349] TRACE Controller 0 epoch 15 started leader election for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:56:37,351] TRACE Controller 0 epoch 15 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:56:37,451] TRACE Broker 0 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@29098977 correlation id 1 from controller 0 epoch 15 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:56:37,459] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 15 starting the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:56:37,526] TRACE Controller 0 epoch 15 elected leader 0 for Offline partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:56:37,530] TRACE Controller 0 epoch 15 changed partition [conso-maison,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-10-15 14:56:37,530] TRACE Controller 0 epoch 15 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:15) to broker 0 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:56:37,531] TRACE Controller 0 epoch 15 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:15) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:56:37,580] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 15 with correlation id 1 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:56:37,583] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 15 for the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:56:37,608] TRACE Controller 0 epoch 15 received response {error_code=0,partitions=[{topic=conso-maison,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:56:37,609] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 15 with correlation id 2 (state.change.logger)
[2017-10-15 14:56:37,610] TRACE Controller 0 epoch 15 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:56:37,611] TRACE Broker 0 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@49f9281a correlation id 3 from controller 0 epoch 15 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:56:37,612] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 15 starting the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:56:37,614] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 15 for partition [conso-maison,0] since it is already the leader for the partition. (state.change.logger)
[2017-10-15 14:56:37,614] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 15 for the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:56:37,617] TRACE Controller 0 epoch 15 received response {error_code=0,partitions=[{topic=conso-maison,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:56:37,618] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 15 with correlation id 4 (state.change.logger)
[2017-10-15 14:56:37,618] TRACE Controller 0 epoch 15 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:58:53,103] TRACE Controller 0 epoch 16 started leader election for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:58:53,124] ERROR Controller 0 epoch 16 initiated state change for partition [kafka-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:684)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController.startup(KafkaController.scala:680)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:200)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:37)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-10-15 14:58:53,127] TRACE Controller 0 epoch 16 started leader election for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:58:53,162] ERROR Controller 0 epoch 16 initiated state change for partition [conso-maisons,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [conso-maisons,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:684)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController.startup(KafkaController.scala:680)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:200)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:37)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-10-15 14:58:53,163] TRACE Controller 0 epoch 16 started leader election for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:58:53,175] ERROR Controller 0 epoch 16 initiated state change for partition [conso-maison,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [conso-maison,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:684)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:680)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController.startup(KafkaController.scala:680)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:200)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:37)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-10-15 14:58:53,570] TRACE Controller 0 epoch 16 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:6,ControllerEpoch:14) to broker 0 for partition conso-maisons-0 (state.change.logger)
[2017-10-15 14:58:53,570] TRACE Controller 0 epoch 16 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:15) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:58:53,571] TRACE Controller 0 epoch 16 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:6,ControllerEpoch:14) to broker 0 for partition kafka-topic-0 (state.change.logger)
[2017-10-15 14:58:53,659] TRACE Controller 0 epoch 16 changed state of replica 0 for partition [conso-maison,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-10-15 14:58:53,660] TRACE Controller 0 epoch 16 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:15) to broker 0 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:58:53,664] TRACE Controller 0 epoch 16 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:15) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:58:53,664] TRACE Controller 0 epoch 16 started leader election for partition [kafka-topic,0] (state.change.logger)
[2017-10-15 14:58:53,699] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:6,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:1) for partition kafka-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 16 with correlation id 0 (state.change.logger)
[2017-10-15 14:58:53,700] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 16 with correlation id 0 (state.change.logger)
[2017-10-15 14:58:53,700] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:6,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:1) for partition conso-maisons-0 in response to UpdateMetadata request sent by controller 0 epoch 16 with correlation id 0 (state.change.logger)
[2017-10-15 14:58:53,713] ERROR Controller 0 epoch 16 initiated state change for partition [kafka-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka-topic,0] is alive. Live brokers are: [Set(0)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:433)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:375)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:843)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-10-15 14:58:53,714] TRACE Controller 0 epoch 16 started leader election for partition [conso-maisons,0] (state.change.logger)
[2017-10-15 14:58:53,759] TRACE Controller 0 epoch 16 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:58:53,783] ERROR Controller 0 epoch 16 initiated state change for partition [conso-maisons,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [conso-maisons,0] is alive. Live brokers are: [Set(0)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:433)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:375)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:843)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-10-15 14:58:53,784] TRACE Controller 0 epoch 16 started leader election for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:58:53,897] TRACE Broker 0 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@3c7dbd5c correlation id 1 from controller 0 epoch 16 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:58:53,905] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 16 starting the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:58:53,948] TRACE Controller 0 epoch 16 elected leader 0 for Offline partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:58:53,952] TRACE Controller 0 epoch 16 changed partition [conso-maison,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-10-15 14:58:53,953] TRACE Controller 0 epoch 16 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:16) to broker 0 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:58:53,953] TRACE Controller 0 epoch 16 sending UpdateMetadata request (Leader:-2,ISR:0,LeaderEpoch:0,ControllerEpoch:16) to broker 0 for partition conso-maison-0 (state.change.logger)
[2017-10-15 14:58:53,971] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 16 with correlation id 1 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:58:53,972] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 16 for the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:58:53,995] TRACE Controller 0 epoch 16 received response {error_code=0,partitions=[{topic=conso-maison,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:58:53,996] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 16 with correlation id 2 (state.change.logger)
[2017-10-15 14:58:53,999] TRACE Controller 0 epoch 16 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:58:54,000] TRACE Broker 0 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@174a7b1a correlation id 3 from controller 0 epoch 16 for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:58:54,000] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 16 starting the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:58:54,002] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 16 for partition [conso-maison,0] since it is already the leader for the partition. (state.change.logger)
[2017-10-15 14:58:54,002] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 16 for the become-leader transition for partition [conso-maison,0] (state.change.logger)
[2017-10-15 14:58:54,004] TRACE Controller 0 epoch 16 received response {error_code=0,partitions=[{topic=conso-maison,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-10-15 14:58:54,006] TRACE Broker 0 deleted partition conso-maison-0 from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 16 with correlation id 4 (state.change.logger)
[2017-10-15 14:58:54,008] TRACE Controller 0 epoch 16 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
